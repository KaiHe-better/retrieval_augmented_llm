2023-11-29 20:53:29,393 **************** Configuration **************** 
2023-11-29 20:53:29,393 ID: 0
2023-11-29 20:53:29,393 config: llama2-7b_USMLE_RA_NIL.yaml
2023-11-29 20:53:29,394 gpu: 5,6,7
2023-11-29 20:53:29,394 seed: 42
2023-11-29 20:53:29,394 num_workers: 16
2023-11-29 20:53:29,394 if_RA: True
2023-11-29 20:53:29,394 LLM: llama2-7b
2023-11-29 20:53:29,394 triever: NIL
2023-11-29 20:53:29,394 dataset: USMLE
2023-11-29 20:53:29,394 prompt_file: prompts/USMLE.json
2023-11-29 20:53:29,394 retrieval_raw_data_dir: datasets/USMLE/textbooks/en
2023-11-29 20:53:29,394 retrieval_processed_file_dir: datasets/USMLE/process_retrieval_corpus/
2023-11-29 20:53:29,394 chunk_size: 512
2023-11-29 20:53:29,394 chunk_overlap: 20
2023-11-29 20:53:29,394 similarity_threshold: 0.7
2023-11-29 20:53:29,394 multi_query: False
2023-11-29 20:53:29,394 max_document_num: 9
2023-11-29 20:53:29,394 retri_batch_size: 512
2023-11-29 20:53:29,394 batch_size: 1
2023-11-29 20:53:29,394 demonstration: False
2023-11-29 20:53:29,394 demons_cnt: 1
2023-11-29 20:53:29,394 temperature: 0
2023-11-29 20:53:29,394 top_p: 0
2023-11-29 20:53:29,394 max_new_tokens: 2
2023-11-29 20:53:29,394 max_length: 2048
2023-11-29 20:53:29,394 device: cuda
2023-11-29 20:53:29,394 dir_path: ./results/output/gpu_5_6_7_config_llama2-7b_USMLE_RA_NIL.yaml
2023-11-29 20:53:29,394 print_logger: <Logger print (DEBUG)>
2023-11-29 20:53:29,394 result_logger: <Logger result (DEBUG)>
2023-11-29 20:53:29,394 **************** Configuration **************** 


2023-11-29 20:53:29,394 loading retriever ...
2023-11-29 20:53:29,395 Loading ../LLM_models/llama2/Llama-2-7b-chat-hf in torch.float16...
2023-11-29 20:54:04,592 Finish loading in 35.20 sec.
2023-11-29 20:54:04,643 Loading data ...
2023-11-29 20:54:04,710 chunk retrieval files ... 

2023-11-29 20:54:06,249 ===============================breaking ===============================
2023-11-29 20:54:06,250 ===============================breaking ===============================
2023-11-29 20:54:06,250 ===============================breaking ===============================
2023-11-29 20:54:06,250 process retrieval files finish in 1.54 sec. 

2023-11-29 20:54:57,555 prompt_format: retrieve-prompt 

2023-11-29 20:54:57,555 updata_retri_embedding ...
