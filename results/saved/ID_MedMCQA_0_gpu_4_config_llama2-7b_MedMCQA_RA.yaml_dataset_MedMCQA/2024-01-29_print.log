2024-01-29 21:35:54,982 **************** Configuration **************** 
2024-01-29 21:35:54,983 ID: MedMCQA_0
2024-01-29 21:35:54,983 gpu: 4
2024-01-29 21:35:54,983 seed: 42
2024-01-29 21:35:54,983 num_workers: 16
2024-01-29 21:35:54,983 test_code_flag: False
2024-01-29 21:35:54,983 loading_ckpt_path: None
2024-01-29 21:35:54,983 if_train: False
2024-01-29 21:35:54,983 if_RA: True
2024-01-29 21:35:54,983 if_MI_RA: False
2024-01-29 21:35:54,983 LLM: llama2-7b
2024-01-29 21:35:54,983 triever: dragon+
2024-01-29 21:35:54,983 num_layers: 1
2024-01-29 21:35:54,983 dataset: MedMCQA
2024-01-29 21:35:54,983 config: llama2-7b_MedMCQA_RA.yaml
2024-01-29 21:35:54,983 chunk_size: 512
2024-01-29 21:35:54,983 chunk_overlap: 20
2024-01-29 21:35:54,983 train_add_gold_retrieval: False
2024-01-29 21:35:54,983 infer_add_gold_retrieval: False
2024-01-29 21:35:54,983 infer_retri_num: 5
2024-01-29 21:35:54,983 pass_retri_num: 3
2024-01-29 21:35:54,983 test_batch_size: 2
2024-01-29 21:35:54,983 multi_query: False
2024-01-29 21:35:54,983 rewrite_num: 1
2024-01-29 21:35:54,983 OTTQA_more_passage: True
2024-01-29 21:35:54,983 retri_batch_size: 320
2024-01-29 21:35:54,983 retrieval_corpus_ids: 0
2024-01-29 21:35:54,983 if_hierarchical_retrieval: True
2024-01-29 21:35:54,983 hierarchical_ratio: 1.4
2024-01-29 21:35:54,984 quantile_num: 0.95
2024-01-29 21:35:54,984 train_retri_num: 5
2024-01-29 21:35:54,984 train_batch_size: 2
2024-01-29 21:35:54,984 accumulation_steps: 1
2024-01-29 21:35:54,984 demonstration: False
2024-01-29 21:35:54,984 demons_cnt: 1
2024-01-29 21:35:54,984 l2_coef: 0
2024-01-29 21:35:54,984 train_eval: 100
2024-01-29 21:35:54,984 epoch: 99999
2024-01-29 21:35:54,984 lr: 0.0001
2024-01-29 21:35:54,984 init_lr_num: 500
2024-01-29 21:35:54,984 lr_decay: 0.9
2024-01-29 21:35:54,984 lr_decay_interval: 400
2024-01-29 21:35:54,984 loss_list: kl_soft+kl_hard
2024-01-29 21:35:54,984 mse_weight: 0
2024-01-29 21:35:54,984 soft_weight: 0.7
2024-01-29 21:35:54,984 hard_weight: 0.3
2024-01-29 21:35:54,984 d_model: 768
2024-01-29 21:35:54,984 dim_feedforward: 2048
2024-01-29 21:35:54,984 layer_norm_eps: 1e-05
2024-01-29 21:35:54,984 nhead: 8
2024-01-29 21:35:54,984 dropout: 0.1
2024-01-29 21:35:54,984 temperature: 1e-09
2024-01-29 21:35:54,984 top_p: 0
2024-01-29 21:35:54,984 max_new_tokens: 1
2024-01-29 21:35:54,984 max_length: 2048
2024-01-29 21:35:54,984 device: cuda
2024-01-29 21:35:54,984 prompt_file: prompts/MedMCQA.json
2024-01-29 21:35:54,984 dir_path: ./results/output/ID_MedMCQA_0_gpu_4_config_llama2-7b_MedMCQA_RA.yaml_dataset_MedMCQA
2024-01-29 21:35:54,985 print_logger: <Logger print (DEBUG)>
2024-01-29 21:35:54,985 test_result_logger: <Logger test_result (DEBUG)>
2024-01-29 21:35:54,985 train_result_logger: <Logger train_result (DEBUG)>
2024-01-29 21:35:54,985 **************** Configuration **************** 


2024-01-29 21:35:54,985 Loading retriever ...
2024-01-29 21:35:56,392 Loading ../LLM_models/llama2/Llama-2-7b-chat-hf in torch.bfloat16...
2024-01-29 21:36:11,946 Finish loading in 0.26 mins.
2024-01-29 21:36:12,044 Loading data ...
2024-01-29 21:36:13,457 prompt_format: retrieve-prompt 

2024-01-29 21:36:13,458 updata_retri_embedding ...
2024-01-29 21:36:13,458 datasets/Retrieval_corpus/process_retrieval_corpus/train_dragon+_512_20_0.txt already chunked !
2024-01-29 21:36:14,729 loading retrieval files in 0.02 mins. 

2024-01-29 21:36:15,236 exist retri_embedding for train , loading it in 0.03 min. 
2024-01-29 21:36:15,237 vectordb train, size: torch.Size([768, 66417])
2024-01-29 21:36:15,237 
 Start test ...  
2024-01-29 21:36:16,880 testing process num: 0
2024-01-29 21:39:55,113 testing process num: 200
2024-01-29 21:43:40,230 testing process num: 400
2024-01-29 21:47:26,711 testing process num: 600
2024-01-29 21:51:18,790 testing process num: 800
2024-01-29 21:55:02,863 testing process num: 1000
2024-01-29 21:58:46,533 testing process num: 1200
2024-01-29 22:02:33,155 testing process num: 1400
2024-01-29 22:06:18,627 testing process num: 1600
2024-01-29 22:10:03,095 testing process num: 1800
2024-01-29 22:13:47,808 testing process num: 2000
2024-01-29 22:15:33,017 test: acc 35.79, f1 33.49, precision 34.14, recall 35.85, old_doc_len:1965.386950286807, new_doc_len:0.0, hallucination: 0.0 
2024-01-29 22:15:33,017 cost_time: 39.29541983207067 
 
