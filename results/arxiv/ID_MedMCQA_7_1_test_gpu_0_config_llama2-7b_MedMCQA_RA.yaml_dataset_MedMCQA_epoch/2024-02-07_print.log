2024-02-07 19:06:11,394 **************** Configuration **************** 
2024-02-07 19:06:11,394 ID: MedMCQA_7_1_test
2024-02-07 19:06:11,394 gpu: 0
2024-02-07 19:06:11,394 seed: 42
2024-02-07 19:06:11,394 num_workers: 16
2024-02-07 19:06:11,394 test_code_flag: False
2024-02-07 19:06:11,394 loading_ckpt_path: None
2024-02-07 19:06:11,394 if_train: False
2024-02-07 19:06:11,394 if_RA: True
2024-02-07 19:06:11,394 if_MI_RA: False
2024-02-07 19:06:11,394 LLM: llama2-7b
2024-02-07 19:06:11,394 triever: dragon+
2024-02-07 19:06:11,394 num_layers: 1
2024-02-07 19:06:11,394 dataset: MedMCQA
2024-02-07 19:06:11,394 config: llama2-7b_MedMCQA_RA.yaml
2024-02-07 19:06:11,395 chunk_size: 512
2024-02-07 19:06:11,395 chunk_overlap: 20
2024-02-07 19:06:11,395 train_add_gold_retrieval: False
2024-02-07 19:06:11,395 infer_add_gold_retrieval: False
2024-02-07 19:06:11,395 infer_retri_num: 5
2024-02-07 19:06:11,395 pass_retri_num: 3
2024-02-07 19:06:11,395 test_batch_size: 2
2024-02-07 19:06:11,395 multi_query: False
2024-02-07 19:06:11,395 rewrite_num: 1
2024-02-07 19:06:11,395 OTTQA_more_passage: True
2024-02-07 19:06:11,395 retri_batch_size: 640
2024-02-07 19:06:11,395 retrieval_corpus_ids: 0
2024-02-07 19:06:11,395 if_hierarchical_retrieval: False
2024-02-07 19:06:11,395 hierarchical_ratio: 1.4
2024-02-07 19:06:11,395 quantile_num: 0.95
2024-02-07 19:06:11,395 train_retri_num: 5
2024-02-07 19:06:11,395 train_batch_size: 2
2024-02-07 19:06:11,395 accumulation_steps: 1
2024-02-07 19:06:11,395 demonstration: False
2024-02-07 19:06:11,395 demons_cnt: 1
2024-02-07 19:06:11,395 l2_coef: 0
2024-02-07 19:06:11,395 train_eval: 100
2024-02-07 19:06:11,395 epoch: 1
2024-02-07 19:06:11,395 lr: 0.0001
2024-02-07 19:06:11,395 init_lr_num: 500
2024-02-07 19:06:11,395 lr_decay: 0.9
2024-02-07 19:06:11,395 lr_decay_interval: 400
2024-02-07 19:06:11,395 loss_list: kl_soft+kl_hard
2024-02-07 19:06:11,395 mse_weight: 0
2024-02-07 19:06:11,395 soft_weight: 0.7
2024-02-07 19:06:11,396 hard_weight: 0.3
2024-02-07 19:06:11,396 d_model: 768
2024-02-07 19:06:11,396 dim_feedforward: 2048
2024-02-07 19:06:11,396 layer_norm_eps: 1e-05
2024-02-07 19:06:11,396 nhead: 8
2024-02-07 19:06:11,396 dropout: 0.1
2024-02-07 19:06:11,396 temperature: 1e-09
2024-02-07 19:06:11,396 top_p: 0
2024-02-07 19:06:11,396 max_new_tokens: 1
2024-02-07 19:06:11,396 max_length: 2048
2024-02-07 19:06:11,396 device: cuda
2024-02-07 19:06:11,396 prompt_file: prompts/MedMCQA.json
2024-02-07 19:06:11,396 dir_path: ./results/output/ID_MedMCQA_7_1_test_gpu_0_config_llama2-7b_MedMCQA_RA.yaml_dataset_MedMCQA_epoch
2024-02-07 19:06:11,396 print_logger: <Logger print (DEBUG)>
2024-02-07 19:06:11,396 test_result_logger: <Logger test_result (DEBUG)>
2024-02-07 19:06:11,396 train_result_logger: <Logger train_result (DEBUG)>
2024-02-07 19:06:11,396 **************** Configuration **************** 


2024-02-07 19:06:11,396 Loading retriever ...
2024-02-07 19:06:12,809 Loading ../LLM_models/llama2/Llama-2-7b-chat-hf in torch.bfloat16...
2024-02-07 19:06:18,493 Finish loading in 0.09 mins.
2024-02-07 19:06:18,591 Loading data ...
2024-02-07 19:06:19,222 prompt_format: retrieve-prompt 

2024-02-07 19:06:19,222 updata_retri_embedding ...
2024-02-07 19:06:19,222 datasets/Retrieval_corpus/process_retrieval_corpus/train_dragon+_512_20_0.txt already chunked !
2024-02-07 19:06:20,465 loading retrieval files in 0.02 mins. 

2024-02-07 19:06:20,568 exist retri_embedding for train , loading it in 0.02 min. 
2024-02-07 19:06:20,569 vectordb train, size: torch.Size([768, 66417])
2024-02-07 19:06:20,569 
 Start test ...  
2024-02-07 19:06:21,486 testing process num: 0
2024-02-07 19:10:22,429 testing process num: 200
2024-02-07 19:14:27,652 testing process num: 400
2024-02-07 19:18:37,345 testing process num: 600
2024-02-07 19:22:35,226 testing process num: 800
2024-02-07 19:26:34,423 testing process num: 1000
2024-02-07 19:30:38,370 testing process num: 1200
2024-02-07 19:34:45,300 testing process num: 1400
2024-02-07 19:38:52,032 testing process num: 1600
2024-02-07 19:42:50,020 testing process num: 1800
2024-02-07 19:46:50,099 testing process num: 2000
2024-02-07 19:50:54,304 testing process num: 2200
2024-02-07 19:54:55,900 testing process num: 2400
2024-02-07 19:58:58,032 testing process num: 2600
2024-02-07 20:02:52,265 testing process num: 2800
2024-02-07 20:06:58,419 testing process num: 3000
2024-02-07 20:08:26,418 test: acc 0.0, f1 0.0, precision 0.0, recall 0.0, old_doc_len:1934.6165853658536, new_doc_len:0.0, hallucination: 0.0 
2024-02-07 20:08:26,418 cost_time: 62.09623200496038 
 
